{"code": "#ifdef GL_ES\nprecision mediump float;\n#endif\n\nuniform float time;\nuniform vec2 resolution;\nuniform vec2 mouse;\n\n#define TWOPI 6.28318530718\n#define PI 3.14159265359\n\n//\tGroovymap\n//\tby Jonathan Proxy\n//\t\n//\tRainbow spot spiral distorted using complex conformal mappings\n\nconst float _periodX = 6.;\nconst float _periodY = 7.;\n\nvec2 cmul(const vec2 a, const vec2 b) {\n  return vec2(a.x*b.x - a.y*b.y, a.x*b.y + a.y*b.x);\n}\nvec2 csq(const vec2 v) {\n  return vec2(v.x*v.x - v.y*v.y, 2.*v.x*v.y);\n}\nvec2 cinv(const vec2 v) {\n  return vec2(v[0],-v[1]) / dot(v, v);\n}\nvec2 cln(const vec2 z) {\n  return vec2(log(length(z)), atan(z.y, z.x)); // +2k pi\n}\n\nvec2 perturbedNewton(in vec2 z) {\n  float a=1.2;\n  mat2 rot=mat2(cos(a),-sin(a),sin(a),cos(a));  \n  for(int i=0; i<1; ++i) {\n    z = rot * (2.*z + cinv(csq(z))) / 3.;\n  }\n  return z;\n}\n\nvec2 pentaplexify(const vec2 z) {\n  vec2 y = z;\n  for(float i=0.; i<TWOPI-0.1; i+=TWOPI/5.) {\n    y = cmul(y, z-vec2(cos(i+.1*time), sin(i+.1*time)));\n  }\n  return y;\n}\n\nvec2 infundibularize(in vec2 z) {\n  vec2 lnz = cln(z) / TWOPI;\n  return vec2(_periodX*(lnz.y) + _periodY*(lnz.x), _periodX*(lnz.x) - _periodY*(lnz.y));\n}\n\nvec3 hsv(float h, float s, float v) {\n  return v * mix(\n    vec3(1.0),\n    clamp((abs(fract(h+vec3(3.0, 2.0, 1.0)/3.0)*6.0-3.0)-1.0), 0.0, 1.0), \n    s);\n}\n\nvec4 rainbowJam(in vec2 z) {\n  vec2 uv = fract(vec2(z[0]/_periodX, z[1]/_periodY))*vec2(_periodX, _periodY);\n  vec2 iz = floor(uv);\n  vec2 wz = uv - iz;\n  return vec4(hsv(pow(iz[0]/_periodX, 1.5),0.9,smoothstep(0.45,0.4,length(wz-vec2(0.5)))), 1.);\n}\n\nvoid main( void ) {\n  gl_FragColor = \n    rainbowJam(infundibularize(pentaplexify(perturbedNewton(3.*(2.*gl_FragCoord.xy-resolution.xy) / resolution.y)))\n  + 0.4*(mouse.xy-0.5)\n  + time * -0.2);\n}\n", "user": "d57cd76", "parent": null, "id": "26451.0"}