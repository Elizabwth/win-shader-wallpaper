{"code": "precision highp float;\n\n// dashxdr pulled this shader from this page:\n// http://wakaba.c3.cx/w/puls.html\n// Changed colors, added fog, did a slight optimization on color calculations\n// Changed some other values which create the field animation\n\nuniform float time;\nuniform vec2 mouse;\nuniform vec2 resolution;\n\nconst float BLOWUP=200.0; /* 86.0 */\nconst float MAXSTEPSHIFT = 15.0; /* 6.0 */\nconst int MAXITERS=50; /* 50 */\n\nconst float pi=3.1415926535;\n\nfloat sum(vec3 v) { return v.x+v.y+v.z; }\n\nint func(vec3 pos,float stepshift)\n{\n\tvec3 v2=abs(fract(pos)-vec3(0.5,0.5,0.5))/2.0;\n\tfloat r=0.12*sin(time*3.);\n\tfloat blowup=BLOWUP/pow(2.0,stepshift+8.0);\n\n\tif(sum(v2)-0.1445+r<blowup) return 1;\n\tv2=vec3(0.25,0.25,0.25)-v2;\n\tif(sum(v2)-0.1-r<blowup) return 2;\n\n\tint hue;\n\tfloat width;\n\tif(abs(sum(v2)-3.0*r-0.375)<0.03846+blowup)\n\t{\n\t\twidth=0.1645;\n\t\thue=4;\n\t}\n\telse\n\t{\n\t\twidth=0.0676;\n\t\thue=3;\n\t}\n\n\tif(sum(abs(v2.zxy-v2.xyz))-width<blowup) return hue;\n\n\treturn 0;\n}\n\nvoid main()\n{\n\tfloat x=0.6*(2.0*gl_FragCoord.x-resolution.x)/max(resolution.x,resolution.y);\n\tfloat y=0.6*(2.0*gl_FragCoord.y-resolution.y)/max(resolution.x,resolution.y);\n\n\tfloat sin_a=sin(time*1.0*0.000564);\n\tfloat cos_a=cos(time*1.0*0.000564);\n\n\tvec3 dir=vec3(x,-y,0.433594-x*x-y*y);\n\tdir=vec3(dir.y,dir.z*cos_a-dir.x*sin_a,dir.x*cos_a+dir.z*sin_a);\n\tdir=vec3(dir.y,dir.z*cos_a-dir.x*sin_a,dir.x*cos_a+dir.z*sin_a);\n\tdir=vec3(dir.y,dir.z*cos_a-dir.x*sin_a,dir.x*cos_a+dir.z*sin_a);\n\n\tvec3 pos=vec3(0.5,3.1875,0.875)+vec3(1.0,1.0,1.0)*0.0134*10.0*time;\n\n\tfloat stepshift=MAXSTEPSHIFT;\n\n\tif(fract(pow(x,y)*time*20.0*200.0)>0.3) pos+=dir/pow(8.0,stepshift);\n\telse pos-=dir/pow(2.0,stepshift);\n\n\tint i=0;\n\tint c;\n\n\tfor(int j=0;j<100;j++)\n\t{\n\t\tc=func(pos,stepshift);\n\t\tif(c>0)\n\t\t{\n\t\t\tstepshift+=1.0;\n\t\t\tpos-=dir/pow(2.0,stepshift);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(stepshift>0.0) stepshift-=1.0;\n\t\t\tpos+=dir/pow(1.8,stepshift);\n\t\t\ti++;\n\t\t}\n\n\t\tif(stepshift>=MAXSTEPSHIFT) break;\n\t\tif(i>=MAXITERS) break;\n\t}\n\n\tvec3 col;\n\tif(c==0) col=vec3(0.0,0.0,0.0);\n\telse if(c==1) col=vec3(1.0,1.0,0.0);\n\telse if(c==2) col=vec3(1.0,0.5,0.0);\n\telse if(c==3) col=vec3(0.7,0.7,0.7);\n\telse if(c==4) col=vec3(0.1,0.1,0.1);\n\n\tfloat k=1.00-(float(i)-stepshift)/39.0;\n\tvec4 f = vec4(k*k);\n\tvec4 fogColor = vec4(.1, 1., 1.1, 1);\n\tf *= fogColor;\n\tgl_FragColor=vec4(col*vec3(k*k),1.0)+f;\n}", "user": "5b69e4c", "parent": "/e#7175.0", "id": "7189.0"}