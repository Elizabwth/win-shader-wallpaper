{"code": "\n#define PROCESSING_COLOR_SHADER\n//  Thematica :  Cercles et Cubes de l'espace en abime\n\n\n#ifdef GL_ES\nprecision mediump float;\n#endif\nuniform float time;\nuniform vec2 resolution;\nuniform vec2 mouse;\n\nfloat pointToGrille( vec3 pp,float b, float r )\n\n\t{\tvec3 p=abs(pp);\n\t\tvec3 pa=mod(p,2.0*b)-b;\n\t\t\n\t\tfloat dy= length( vec2(b - length(pa.xz), pa.y));\n\t\tfloat dz= length( vec2(b - length(pa.xy), pa.z));\n\t\tfloat ddy= length( vec3( pa.x  ,  pa.z,  pa.y*step(0.0,pa.y) ));\n\t\tfloat ddz= length( vec3(pa.x   , pa.y ,  pa.z*step(0.0,pa.z) ));\n\t\t\n\t\treturn min(min(dy,ddy),min(dz,ddz))-r;\n\t\t\n\t}\t\n\t\n\nvec3 rotor( vec3 p)\n\t{\tfloat co=time*0.1;\t\t\t\t\n\t\tfloat  c = cos(co);\n\t\tfloat  s = sin(co);\n\t\tmat3   mz = mat3(c,-s,0.0,s,c,0.0,0.0,0.0,1.0);\n\t\tmat3 mx=mat3(1.0,0.0,0.0, 0.0,c,-s, 0.0,s,c);\n\t\tmat3 m=mz*mx;\n \t  return  p*m;\n \t  }\n\n\n//----------------------------------------------------------------------\n\nfloat render( vec3 org, vec3 dir){\n\tfloat lambda = 0.0;\n\tvec3 pos= org ;\n\tfloat lamb=100.0;\n\tfloat couleur=0.0;\nfor(int  i=0; i<100; i++){\t\n\tlamb= pointToGrille(pos,12.0,0.8);\n\tlambda+=lamb;\n\tpos=org+lambda*dir;\n\tcouleur+=0.01;\n\tif(abs(lamb)<1.0e-4) break;\n}\n\t\treturn clamp(couleur*1.3,0.0,1.0);\n}\n\n//----------------------------------------------------------------------\nvoid main( void )\n{\n\tvec2 p= gl_FragCoord.xy/resolution.xy -0.5;\n\tp.x*=resolution.x/resolution.y;\t\n\t\t\t\t\t// camera\t\n\tvec3 oeil=vec3(0.0,0.0,-1.62);\t\t\n\t\t\t\t\t// rotation de la camera\t\n\t oeil=rotor(oeil);\n\t \t\t\t\t//direction\n\toeil.x += sin(time*0.01436) * 500.0;\n\toeil.y += cos(time*0.01) * 500.0;\n\toeil.z += sin(time*0.01352) * 500.0;\n\tvec3 dirRayon=normalize(rotor(vec3(p.x,p.y,1.60)));\n\t\t\t\t\t//calcul de la couleur\n\tfloat  coul = render( oeil+12.0*dirRayon, dirRayon );\n\tvec3 color=vec3(1.0-coul,coul,1.0-coul);\n\tcolor=cross(color,dirRayon) ;\n\tgl_FragColor=vec4(color,1.0);\n}", "user": "b46edec", "parent": "/e#8834.2", "id": "8836.0"}