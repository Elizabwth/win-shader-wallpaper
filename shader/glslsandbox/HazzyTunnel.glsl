{"code": "#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform vec2 resolution;\nuniform float time;\n\n//Object A (tunnel)\nfloat oa(vec3 q) {  return cos(q.x*0.5)+cos(q.y*0.5)+cos(q.z*1.9)+cos(q.y*1.)*.1; }\n\n//Scene\nfloat o(vec3 q) { return min(oa(q),1.); }\n\n//Get Normal\nvec3 gn(vec3 q) { vec3 f=vec3(.01,0,0); return normalize(vec3(o(q+f.xyy),o(q+f.yxy),o(q+f.yyx))); }\n\n//MainLoop\nvoid main(void) {\n\n vec2 p = -1.0 + 2.0 * gl_FragCoord.xy / resolution.xy;\n p.x *= resolution.x/resolution.y;\n \n vec4 c=vec4(1.9);\n vec3 org=vec3(sin(time)*.5,cos(time*.5)*0.25+.25,time),dir=normalize(vec3(p.x*1.6,p.y,1.0)),q=org,pp;\n float d=.0;\n\n //First raymarching\n for(int i=0;i<32;i++) {\n  d=o(q);\n  q+=d*dir;\n }\n pp=q;\n float f=length(q-org)*0.02;\n\n //Second raymarching (reflection)\n dir=reflect(dir,gn(q));\n q+=dir;\n for(int i=0;i<4;i++)\n {\n d=o(q);\n q+=d*dir;\n }\n c=max(dot(gn(q),vec3(.1,.1,.0)),.0)+vec4(.3,cos(time*.5)*.5+.5,sin(time*.5)*.5+.5,1.)*min(length(q-org)*.04,1.);\n\n //Final Color\n vec4 fcolor = ((c+vec4(f))+(1.-min(pp.y+1.9,1.))*vec4(1.,.8,.7,1.))*min(time*.5,1.);\n gl_FragColor=vec4(fcolor.xyz,1.0);\n}", "user": "5887156", "parent": "/e#5014.0", "id": "5051.0"}