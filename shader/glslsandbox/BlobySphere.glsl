{"code": "#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform float time;\nuniform vec2 mouse;\nuniform vec2 resolution;\n\nfloat sphere(vec3 p)\n{\n\treturn length(p)-5.;\n}\n\nfloat displacement(vec3 p)\n{\n\treturn sin(p.x*4.0)*sin(p.y*4.0)*2.0*sin(p.z*4.0-time*8.0)/8.0;\n}\n\nfloat obj( vec3 p )\n{\n\tfloat d1 = sphere(p);\n    \tfloat d2 = displacement(p);\n    \treturn d1+d2;\n}\n\nvec3 obj_c( vec3 p ){\n\treturn vec3(.3,0.5,0.8);\n}\n\t\nvoid main( void ) {\n  vec2 vPos=-1.0+2.0*gl_FragCoord.xy/resolution.xy;\n\n  //Camera animation\n  vec3 vuv=vec3(0,1,0);//Change camere up vector here\n  vec3 vrp=vec3(0,1,0); //Change camere view here \n  vec3 prp=vec3(sin(time)*8.0,4,cos(time)*8.0);\n\t\n  //Camera setup\n  vec3 vpn=normalize(vrp-prp);\n  vec3 u=normalize(cross(vuv,vpn));\n  vec3 v=cross(vpn,u);\n  vec3 vcv=(prp+vpn);\n  vec3 scrCoord=vcv+vPos.x*u*resolution.x/resolution.y+vPos.y*v;\n  vec3 scp=normalize(scrCoord-prp);\n\n  //Raymarching\n  const float maxd=60.0; //Max depth\n  const vec2 e=vec2(0.01,-0.01);\n  float s=0.1;\n  vec3 c,p,n;\n\n  float f=1.0;\n  for(int i=0;i<32;i++){\n    if (abs(s)<e.x||f>maxd) break;\n    f+=s;\n    p=prp+scp*f;\n    s=obj(p);\n  }\n  \n  if (f<maxd){\n    c=obj_c(p);\n    vec4 v=vec4(\n\t    obj(vec3(p+e.xyy)),obj(vec3(p+e.yyx)),\n\t    obj(vec3(p+e.yxy)),obj(vec3(p+e.xxx)));\n    n=normalize(vec3(v.w+v.x-v.z-v.y,v.z+v.w-v.x-v.y,v.y+v.w-v.z-v.x));\n    float b=dot(n,normalize(prp-p));\n    gl_FragColor=vec4((b*c+pow(b,8.0))*(1.0-f*.02),1.0);\n  }\n  else gl_FragColor=vec4(0,0,0,1); //background color\n}", "user": "ee07063", "parent": "/e#4028.0", "id": "4029.1"}