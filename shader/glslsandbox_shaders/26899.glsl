{"code": "#ifdef GL_ES\nprecision mediump float;\n#endif\n\nuniform float time;\nuniform vec2 mouse;\nuniform vec2 resolution;\n\n#define STEPSEC 1\n#define HASCHRONO 0;\n#define PI 3.14159265359\n#define SCALE 0.75\n\nconst float radius   = 0.33;\nconst float radius_h = 0.29;\nconst float radius_m = 0.30;\nconst vec3 color1 = 0.8*vec3(0.2,0.9,0.7);\nconst vec3 color2 = vec3(1.1,0.05,0.05);\n\nfloat d2y(float d){return 1./(0.2+d);}\n\nvec2 p;\nfloat a,r;\n\n\nfloat angle(vec2 orig){\n\tvec2 t = p-orig;\n\treturn 0.5-atan(t.x, -t.y)/(2.*PI);\n}\n\nfloat dtick(float r, float a, float n, float l, float f0, float f1){\n\tfloat h = f1*abs(fract(n*a+0.5)-0.5);\n\tfloat hi = f0*max(0., l-r);\n\treturn 9.*length(vec2(h,hi));\n}\n\nfloat ticks(){\n\tfloat a = 0.5-atan(p.x, -p.y)/(2.*PI);\n\t\n\tfloat dh = dtick(r, a, 12., radius_h, 35., 6.);\n\tfloat dm = dtick(r, a, 60., radius_m, 200., 5.);\n\t\n\treturn d2y(dh) + d2y(dm);\n}\n\n   \nfloat circle(float R){\n    float d=distance(r, R);\n    return d2y(200.*d);\n}\n\nfloat hands(float e){\n\tfloat s = mod(time,60.); // 0.00->0.99\n\t#if STEPSEC\n\ts=floor(s);\n\t#endif\n\tfloat ah = 60.*a;\n\tfloat dr = 0.5*r*min(min(abs(s-ah),abs(s-ah+60.)),abs(s-ah-60.));\n\tfloat dl = 4.*max(0., r-0.27);\n\tfloat d = length(vec2(dr, dl));\n\tfloat x = 0.01;\n\treturn d2y(e*d) * step(x,r) + circle(x);\n}\n\nfloat chrono(float e, vec2 orig, float k){\n\tfloat s = mod(time,k); // 0.00->0.99\n\tfloat r = distance(p,orig);\n\tfloat ah = k*angle(orig);\n\tfloat dr = 20.*r*min(min(abs(s-ah),abs(s-ah+k)),abs(s-ah-k));\n\tfloat dl = 4.*max(0., r-0.03);\n\tfloat d = length(vec2(dr, dl));\n\treturn d2y(e*d);\n}\n\n\nvoid main( void ) {\n\tp = SCALE*(gl_FragCoord.xy-0.5*resolution)/ resolution.y ;\n\tr = length(p);\n\ta = angle(vec2(0.));\n\tfloat inCircle = step(r,radius);\n\t\n\tvec2 y = vec2(0.);\n\ty.x += circle(radius);\n\ty.x += ticks() * inCircle;\n\t\n\ty.y += hands(50.);\n\ty.y += chrono(80., vec2(0.15,-0.12),1.); \n\ty = pow(y, vec2(0.9));\n\tvec3 rgb = y.x*color1+y.y*color2;\n\trgb = 0.8*mix(rgb,rgb.gbr+rgb.brg,0.15);\n\tgl_FragColor = vec4(rgb, 1.0);\n}", "user": "d1f88ca", "parent": "/e#26872.4", "id": "26899.11"}