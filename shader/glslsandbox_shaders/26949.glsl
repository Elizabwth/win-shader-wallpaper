{"code": "#ifdef GL_ES\nprecision mediump float;\n#endif\n\n// testing by nodj \n\nuniform float time;\nuniform vec2 mouse;\nuniform vec2 resolution;\n\nvec2  p  = vec2(0.);\nvec2  ci = vec2(0.);\nvec2  cs = vec2(0.);\nvec3 spotColor = vec3(0.2,0.5,0.8);\nvec3 backColor = vec3(0.);\nvec3 lightColor = vec3(1.,0.5,0.1);\n\nfloat r   = 0.;\nvec3  rgb = vec3(0.);\nfloat k = 0.;\nfloat y = 0.;\nfloat y2 = 0.;\n\n#define N 40\n#define Nf float(N)\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nvoid compCellY(){\n\ty = sin(ci.x*0.3 + 2.6*cos(0.1*time)) + cos(ci.y*0.8+4.*cos(0.05*time) * 0.7*ci.x);\n\ty = clamp(0.5+0.25*y,0.,1.);\n\t\n}\n\nvoid mask(){\n\tfloat yn = clamp(0.8*(y+y2), 0.,1.);\n\tfloat d = length((cs-vec2(0.5))*vec2(pow(yn, -2.),1.));\n\tk = 1.-smoothstep(0.40,0.52, d);\n\tk*= 0.3+0.7*cos((cs.x-0.5)*3.14159*pow(yn,-2.));\n}\n\nvoid main( void ) {\n\t\n\tp = (gl_FragCoord.xy-0.5*resolution)/ resolution.y ;\n\t\n\tvec2 cm = (mouse-0.5) * resolution / resolution.y;\n\t//cm = floor(cm*Nf);\n\tcm *= Nf;\n\t\n\tci = floor(p*Nf);\n\tcs = fract(p*Nf);\n\t\n\t\t\n\tcompCellY();\n\ty2=1.2/(0.99+0.05*distance(cm,ci));\n\t\n\t//compLighting();\n\tmask();\n\t\n\t\n\tr = length(p);\n\t// a = angle(vec2(0.));\n\n\tspotColor = hsv2rgb(vec3(0.1*time + 0.3*p.x+0.1*p.y, 0.6, 0.6));\n\t\n\t\n\trgb = mix(backColor, vec3(pow(1.3*y,2.)*spotColor) + vec3(pow(1.3*y2,2.)*lightColor), k);\n\tgl_FragColor = vec4(rgb, 1.0 );\n\n}", "user": "d1f88ca", "parent": null, "id": "26949.16"}