{"code": "#ifdef GL_ES\nprecision mediump float;\n#endif\n\n#extension GL_OES_standard_derivatives : enable\n\n//Shitty fireworks by czpal\n\nuniform float time;\nuniform vec2 mouse;\nuniform vec2 resolution;\n\n\nconst float tb = 2.0;\nconst int nr_of_fireworks = 3;\n\n\n\nvec4 getFirework(float t, float seed)\n{\n\tt+=seed*100.0;\n\tfloat tmp = mod(t,tb);\n\tfloat x = (cos(floor(t/tb)*3.234)+1.5)/3.0;\n\treturn vec4(x, (log(tmp*10.0)/tb)*0.5, tmp+seed, floor(t/tb));\n}\n\nvec3 getColor(float tmp)\n{\n\treturn vec3((1.+cos(tmp))*.5, (1.+sin(tmp))*.5, (1.+cos(tmp*tmp))*.5);\n}\n\nvec3 calculateFireworks(vec2 position, float tab[nr_of_fireworks])\n{\n\tvec3 color;\n\t\n\t\n\tfor(int i = 0;i<nr_of_fireworks;i++)\n\t{\n\t\tvec4 firework = getFirework(time, tab[i]);\n\t\t\n\t\tvec3 value = getColor(firework.w);\n\t\tif(firework.z<tb*0.6)\n\t\t\tvalue *= 0.003/distance(position, firework.xy);\n\t\telse\n\t\t{\n\t\t\tvec2 tmp1 = (firework.xy-position);//abs(abs(position - firework.xy)+(tb*0.6-firework.z)*0.2);\n\t\t\t#define R2(T) mat2(cos(T),sin(T),-sin(T),cos(T))\n\t\t\tfloat accum = (firework.z-tb*0.6);\n\t\t\tfloat produ = 1.;\n\t\t\tfor(float i = 0.; i <= 8.; i += 1.001){\n\t\t\t\tprodu *= accum;\n\t\t\t\ttmp1 += (mouse)*sign(tmp1)*(-0.1-0.1*i)*produ;\n\t\t\t\ttmp1 *= R2(time/max(12.-i, 1.0));\n\t\t\t\t\n\t\t\t}\n\t\t\tfloat tmp2 = atan(tmp1.y, tmp1.x);\n\t\t\t\n\t\t\tvalue *= (0.01/length(tmp1)) * sin((firework.z-tb*0.6)*3.0);\n\t\t\tvalue *= (sin(tmp2*firework.z*20.0)+1.0)*0.5;\n\t\t\t\n\t\t\tvalue /= (6.+10.*accum);\n\t\t\tvalue += dot(value,value)*(0.1+value);\n\t\t}\n\t\tcolor = mix(color, value, 0.5);\n\t}\t\n\t\t\n\treturn color;\n}\n\n\n\nvoid main( void ) \n{\n\tvec2 position = ( gl_FragCoord.xy / resolution.xy );\n\t\n\tfloat tab[nr_of_fireworks];\n\ttab[0] = 0.0;\n\ttab[1] = 0.6;\n\ttab[2] = 1.0;\n\t\n\t\n\t\n\tvec3 value = calculateFireworks(position, tab);\n\t\n\tgl_FragColor = vec4(value,1);\n\n}", "user": "5d59050", "parent": "/e#47275.9", "id": 47276}